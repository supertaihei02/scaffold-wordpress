!function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=5)}({5:function(e,t){document.addEventListener("DOMContentLoaded",function(){function e(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!0,r="";for(var o in e)r+=n?t?"":"?":"&",r+=o+"="+e[o],n=!1;return r}function t(e){var t=e.currentTarget;n(document.querySelector("input[name=success_url]").value,t)}function n(t,n){var r={action:"auth_google_api",success_url:t},o=new XMLHttpRequest;o.onreadystatechange=function(e){if(4===o.readyState)if(200===o.status){var t=JSON.parse(o.responseText.trim());if(t.success)window.open(t.auth_url,"_self");else{var r=document.querySelector("#err-"+n.id);r.innerHTML=t.error,r.classList.remove("hidden")}}else console.log(o.statusText)},o.onerror=function(e){console.log(e.type)},o.open("POST",u+"?auth_google_api",!0),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.send(e(r,!0))}function r(e){var t=e.currentTarget,n=t.attributes,r=n.option_group.nodeValue,u=n.sheet_name.nodeValue,a=n.spread_sheet_id.nodeValue,c=n.spread_sheet_url.nodeValue,s=document.querySelector("#"+a),i=!1;s.value.trim().length>0?window.confirm("本当に実行しますか？(現在セットされているSheetIDは削除されます)")&&(i=!0):i=!0,i&&o(r,u,a,c)}function o(t,n,r,o){var a="create_google_spread_sheet",c={action:a,sheet_name:n,sheet_id_name:r,sheet_url_name:o,option_group:t},s=new XMLHttpRequest;s.onreadystatechange=function(e){if(4===s.readyState)if(200===s.status){var t=JSON.parse(s.responseText.trim());if(t.success){var n=document.querySelector("#"+r);n&&(n.value=t.sheet_id)}else console.log(t.error)}else console.log(s.statusText)},s.onerror=function(e){console.log(e.type)},s.open("POST",u+"?"+a,!0),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.send(e(c,!0))}var u=customizer.ajax_url;!function(){var e=document.querySelectorAll(".auth_google_client"),n=document.querySelectorAll(".create_spread_sheet");e&&e&&e.forEach(function(e){e.addEventListener("click",t,!1)}),n&&n&&n.forEach(function(e){e.addEventListener("click",r,!1)})}()},!1)}});